"use strict";(()=>{var p=class{COMPONENT_SELECTOR='[data-slider-el="component"]';NAV_PREV_BUTTON_SELECTOR='[data-slider-el="nav-prev"]';NAV_NEXT_BUTTON_SELECTOR='[data-slider-el="nav-next"]';constructor(){console.info("[StorySlider] init"),this.bindInnerSliderBoundaryClicks()}bindInnerSliderBoundaryClicks(){let e=document.querySelectorAll(`dialog[data-dialog-id] ${this.COMPONENT_SELECTOR}`);console.info(`[StorySlider] inner sliders inside dialogs found: ${e.length}`),e.forEach((t,i)=>{console.debug("[StorySlider] binding inner slider",{idx:i,componentEl:t}),t.addEventListener("click",o=>{let r=o.target;if(!r)return;let n=r.closest(this.NAV_NEXT_BUTTON_SELECTOR),s=r.closest(this.NAV_PREV_BUTTON_SELECTOR),d=a=>!!a&&a.closest(this.COMPONENT_SELECTOR)===t;if(d(n)){let a=this.isNavDisabled(n),l=this.getInnerActivePosition(t),c=!!l&&l.index===l.count-1;console.log("[StorySlider] next clicked",{idx:i,disabled:a,atLast:c,nextBtn:n}),c&&(o.preventDefault(),o.stopPropagation(),this.handoffToAdjacentStory(t,"next"));return}if(d(s)){let a=this.isNavDisabled(s),l=this.getInnerActivePosition(t),c=!!l&&l.index===0;console.log("[StorySlider] prev clicked",{idx:i,disabled:a,atFirst:c,prevBtn:s}),c&&(o.preventDefault(),o.stopPropagation(),this.handoffToAdjacentStory(t,"prev"));return}})})}isNavDisabled(e){return e.classList.contains("is-disabled")||e.getAttribute("aria-disabled")==="true"||e.hasAttribute("disabled")}handoffToAdjacentStory(e,t){let i=e.closest("dialog[data-dialog-id]");if(!i){console.warn("[StorySlider] no current dialog found for inner slider");return}let o=i.closest(".swiper"),r=i.closest(".swiper-slide"),n=null;if(o&&r){let d=o.querySelector(".swiper-wrapper"),a=d?Array.from(d.children).filter(u=>u.classList?.contains("swiper-slide")&&!u.classList?.contains("swiper-slide-duplicate")):[],l=a.indexOf(r);if(l===-1){let u=r.getAttribute("data-swiper-slide-index"),T=u?Number.parseInt(u,10):NaN;Number.isNaN(T)||(l=T)}let g=l+(t==="next"?1:-1);n=a[g]??null,console.debug("[StorySlider] seeking target via indexed siblings",{dir:t,found:!!n,currentIndex:l,targetIndex:g,slidesCount:a.length})}if(!n){console.warn("[StorySlider] no target outer slide found",{dir:t});return}let s=n.querySelector("dialog[data-dialog-id]");if(!s){console.warn("[StorySlider] target slide has no dialog",{dir:t,targetSlide:n});return}console.log("[StorySlider] handoff",{dir:t,fromDialog:i.getAttribute("data-dialog-id"),toDialog:s.getAttribute("data-dialog-id")}),this.closeDialog(i),this.openDialog(s)}getInnerActivePosition(e){let i=e.querySelector(".swiper")?.querySelector(".swiper-wrapper");if(!i)return null;let o=Array.from(i.querySelectorAll(".swiper-slide:not(.swiper-slide-duplicate)")),r=o.length;if(r===0)return{index:0,count:0,activeEl:null};let n=i.querySelector(".swiper-slide.is-active");n||(n=i.querySelector(".swiper-slide-active"));let s=o.findIndex(d=>d===n);return{index:s<0?0:s,count:r,activeEl:n}}openDialog(e){typeof e.showModal=="function"?e.showModal():e.setAttribute("open","");let t=new CustomEvent("dialogOpen",{detail:{dialogId:e.getAttribute("data-dialog-id")}});e.dispatchEvent(t)}closeDialog(e){typeof e.close=="function"?e.close():e.removeAttribute("open");let t=new CustomEvent("dialogClose",{detail:{dialogId:e.getAttribute("data-dialog-id")}});e.dispatchEvent(t)}};console.info("[StorySlider] script loaded");window.Webflow=window.Webflow||[];window.Webflow.push(()=>{new p});})();
