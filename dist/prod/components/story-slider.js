"use strict";(()=>{function z(a,o){let l;return a=gsap.utils.toArray(a),o=o||{},gsap.context(()=>{let d=o.onChange,p=0,e=gsap.timeline({repeat:o.repeat,onUpdate:d&&function(){let t=e.closestIndex();p!==t&&(p=t,d(a[t],t))},paused:o.paused,defaults:{ease:"none"},onReverseComplete:()=>e.totalTime(e.rawTime()+e.duration()*100)}),i=a.length,E=a[0].offsetLeft,g=[],h=[],b=[],y=[],u=0,C=!1,w=o.center,S=(o.speed||1)*100,x=o.snap===!1?t=>t:gsap.utils.snap(o.snap||1),M=0,A=w===!0?a[0].parentNode:gsap.utils.toArray(w)[0]||a[0].parentNode,m,F=()=>a[i-1].offsetLeft+y[i-1]/100*h[i-1]-E+b[0]+a[i-1].offsetWidth*gsap.getProperty(a[i-1],"scaleX")+(parseFloat(o.paddingRight)||0),R=()=>{let t=A.getBoundingClientRect(),r;a.forEach((n,s)=>{h[s]=parseFloat(gsap.getProperty(n,"width","px")),y[s]=x(parseFloat(gsap.getProperty(n,"x","px"))/h[s]*100+gsap.getProperty(n,"xPercent")),r=n.getBoundingClientRect(),b[s]=r.left-(s?t.right:t.left),t=r}),gsap.set(a,{xPercent:n=>y[n]}),m=F()},I,P=()=>{M=w?e.duration()*(A.offsetWidth/2)/m:0,w&&g.forEach((t,r)=>{g[r]=I(e.labels["label"+r]+e.duration()*h[r]/2/m-M)})},N=(t,r,n)=>{let s=t.length,c=1e10,T=0,f;for(;s--;)f=Math.abs(t[s]-r),f>n/2&&(f=n-f),f<c&&(c=f,T=s);return T},H=()=>{let t,r,n,s,c;for(e.clear(),t=0;t<i;t++)r=a[t],n=y[t]/100*h[t],s=r.offsetLeft+n-E+b[0],c=s+h[t]*gsap.getProperty(r,"scaleX"),e.to(r,{xPercent:x((n-c)/h[t]*100),duration:c/S},0).fromTo(r,{xPercent:x((n-c+m)/h[t]*100)},{xPercent:y[t],duration:(n-c+m-n)/S,immediateRender:!1},c/S).add("label"+t,s/S),g[t]=s/S;I=gsap.utils.wrap(0,e.duration())},B=t=>{let r=e.progress();e.progress(0,!0),R(),t&&H(),P(),t&&e.draggable&&e.paused()?e.time(g[u],!0):e.progress(r,!0)},U=()=>B(!0),L;gsap.set(a,{x:0}),R(),H(),P(),window.addEventListener("resize",U);function _(t,r){r=r||{},Math.abs(t-u)>i/2&&(t+=t>u?-i:i);let n=gsap.utils.wrap(0,i,t),s=g[n];return s>e.time()!=t>u&&t!==u&&(s+=e.duration()*(t>u?1:-1)),(s<0||s>e.duration())&&(r.modifiers={time:I}),u=n,r.overwrite=!0,gsap.killTweensOf(L),r.duration===0?e.time(I(s)):e.tweenTo(s,r)}if(e.toIndex=(t,r)=>_(t,r),e.closestIndex=t=>{let r=N(g,e.time(),e.duration());return t&&(u=r,C=!1),r},e.current=()=>C?e.closestIndex(!0):u,e.next=t=>_(e.current()+1,t),e.previous=t=>_(e.current()-1,t),e.times=g,e.progress(1,!0).progress(0,!0),o.reversed&&(e.vars.onReverseComplete(),e.reverse()),o.draggable&&typeof Draggable=="function"){L=document.createElement("div");let t=gsap.utils.wrap(0,1),r,n,s,c,T,f,V,W=()=>e.progress(t(n+(s.startX-s.x)*r)),X=()=>e.closestIndex(!0);typeof InertiaPlugin>"u"&&console.warn("InertiaPlugin required for momentum-based scrolling and snapping. https://greensock.com/club"),s=Draggable.create(L,{trigger:a[0].parentNode,type:"x",onPressInit(){let O=this.x;gsap.killTweensOf(e),V=!e.paused(),e.pause(),n=e.progress(),B(),r=1/m,f=n/-r-O,gsap.set(L,{x:n/-r})},onDrag:W,onThrowUpdate:W,overshootTolerance:0,inertia:!0,snap(O){if(Math.abs(n/-r-this.x)<10)return T+f;let q=-(O*r)*e.duration(),k=I(q),G=g[N(g,k,e.duration())],v=G-k;return Math.abs(v)>e.duration()/2&&(v+=v<0?e.duration():-e.duration()),T=(q+v)/e.duration()/-r,T},onRelease(){X(),s.isThrowing&&(C=!0)},onThrowComplete:()=>{X(),V&&e.play()}})[0],e.draggable=s}return e.closestIndex(!0),p=u,d&&d(a[u],u),l=e,()=>window.removeEventListener("resize",U)}),l}var j=".section_stories",J=document.querySelectorAll(j),D=class{COMPONENT_SELECTOR='[data-slider-el="component"]';NAV_PREV_BUTTON_SELECTOR='[data-slider-el="nav-prev"]';NAV_NEXT_BUTTON_SELECTOR='[data-slider-el="nav-next"]';STORIES_ITEM_SELECTOR=".stories_item";ACTIVE_SLIDE_CLASS="is-active";sectionEl;storyItemsList;storyItemCount=0;constructor(o){if(window.IS_DEBUG_MODE&&console.info("[StorySlider] init"),this.sectionEl=o,this.storyItemsList=Array.from(this.sectionEl.querySelectorAll(this.STORIES_ITEM_SELECTOR)),this.storyItemCount=this.storyItemsList.length,!this.storyItemCount){console.warn("[StorySlider] no story items found");return}this.initDraggableMainSlider(),this.sectionEl.querySelectorAll("dialog").forEach(l=>{l.addEventListener("storyHandoff",d=>{let p=d,e=p.target,i=p.detail.direction;this.handoffToAdjacentStory(e,i)})})}initDraggableMainSlider(){let o,l=z(this.storyItemsList,{paused:!0,draggable:!0,center:!0,onChange:(d,p)=>{o&&o.classList.remove(this.ACTIVE_SLIDE_CLASS),d.classList.add(this.ACTIVE_SLIDE_CLASS),o=d}});this.sectionEl.querySelector(`${this.NAV_NEXT_BUTTON_SELECTOR}:not(.story-modal_nav-button)`)?.addEventListener("click",()=>l.next({duration:.4,ease:"power1.inOut"})),this.sectionEl.querySelector(`${this.NAV_PREV_BUTTON_SELECTOR}:not(.story-modal_nav-button)`)?.addEventListener("click",()=>l.previous({duration:.4,ease:"power1.inOut"}))}handoffToAdjacentStory(o,l){let d=o.closest("dialog[data-dialog-id]");if(!d){console.warn("[StorySlider] no current dialog found for inner slider");return}let p,e=d.closest(this.STORIES_ITEM_SELECTOR),i=this.storyItemsList.indexOf(e);l==="next"?i===this.storyItemCount-1?p=this.storyItemsList[0]:p=this.storyItemsList[i+1]:i===0?p=this.storyItemsList[this.storyItemCount-1]:p=this.storyItemsList[i-1];let E=p.querySelector("dialog[data-dialog-id]");if(!E){console.warn("[StorySlider] target slide has no dialog",{dir:l});return}window.IS_DEBUG_MODE&&console.log("[StorySlider] handoff",{dir:l,fromDialog:d.getAttribute("data-dialog-id"),toDialog:E.getAttribute("data-dialog-id")}),this.openDialog(E),this.closeDialog(d),l==="next"?E.dispatchEvent(new CustomEvent("sliderJump",{bubbles:!0,detail:{direction:"first"}})):E.dispatchEvent(new CustomEvent("sliderJump",{bubbles:!0,detail:{direction:"last"}}))}openDialog(o){typeof o.showModal=="function"?o.showModal():o.setAttribute("open","");let l=new CustomEvent("dialogOpen",{detail:{dialogId:o.getAttribute("data-dialog-id")}});o.dispatchEvent(l)}closeDialog(o){typeof o.close=="function"?o.close():o.removeAttribute("open");let l=new CustomEvent("dialogClose",{detail:{dialogId:o.getAttribute("data-dialog-id")}});o.dispatchEvent(l)}};window.IS_DEBUG_MODE&&console.info("[StorySlider] script loaded");window.Webflow=window.Webflow||[];window.Webflow.push(()=>{J.forEach(a=>{new D(a)})});})();
