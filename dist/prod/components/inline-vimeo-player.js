"use strict";(()=>{var o=class{VIDEO_WRAP_SELECTOR="[data-interview-video-el]";VIDEO_URL_ATTR="data-video-url";PLAY_STATE_ATTR="data-play-state";PLAY_STATE_HOVER="hover";PLAY_STATE_PLAYING="playing";PLAY_STATE_PAUSED="paused";PLAY_STATE_NONE="none";observer;videoInstances=new Map;currentlyPlaying=null;constructor(){this.observer=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&this.initializeVideo(t.target)})},{rootMargin:"500px",threshold:0}),this.initializeAll()}initializeAll(){let e=document.querySelectorAll(this.VIDEO_WRAP_SELECTOR);if(e.length===0){console.debug("[InlineVimeoPlayer] No video wraps found");return}e.forEach(t=>{this.observer.observe(t)}),window.IS_DEBUG_MODE&&console.debug("[InlineVimeoPlayer] Observing",e.length,"video wraps")}async fetchThumbnail(e){try{let t=await fetch(`https://vimeo.com/api/oembed.json?url=${encodeURIComponent(e)}&height=1920`);return t.ok?(await t.json()).thumbnail_url||null:(window.IS_DEBUG_MODE&&console.error(`[InlineVimeoPlayer] Failed to fetch thumbnail for the video: ${e}`,t.statusText),null)}catch(t){return console.error("[InlineVimeoPlayer] Error fetching thumbnail:",t),null}}async initializeVideo(e){if(this.observer.unobserve(e),this.videoInstances.has(e))return;let t=e.getAttribute(this.VIDEO_URL_ATTR);if(!t){console.error("[InlineVimeoPlayer] No video URL found on wrap",e);return}let a=await this.fetchThumbnail(t);if(e.style.setProperty("--thumb",`url('${a}')`),!window.Vimeo?.Player){console.error("[InlineVimeoPlayer] Vimeo API not available");return}try{let i=new window.Vimeo.Player(e,{url:t,background:!0,muted:!0,autoplay:!0,loop:!0});await i.ready(),await i.setCurrentTime(1),await i.pause(),this.videoInstances.set(e,i);let r=!1,s=async()=>{r&&(r=!1,this.currentlyPlaying=null,e.setAttribute(this.PLAY_STATE_ATTR,this.PLAY_STATE_PAUSED),await i.pause())};this.videoInstances.set(e,{player:i,pauseVideo:s}),e.addEventListener("mouseenter",async()=>{if(!r)try{await i.setMuted(!0),await i.play(),e.setAttribute(this.PLAY_STATE_ATTR,this.PLAY_STATE_HOVER)}catch(n){console.error("[InlineVimeoPlayer] Error playing on hover:",n)}}),e.addEventListener("mouseleave",async()=>{if(!(r||await i.getPaused())){e.setAttribute(this.PLAY_STATE_ATTR,this.PLAY_STATE_NONE);try{await i.pause()}catch(n){console.error("[InlineVimeoPlayer] Error pausing on hover leave:",n)}}}),e.addEventListener("click",async()=>{if(r)await s();else{if(this.currentlyPlaying&&this.currentlyPlaying!==e){let n=this.videoInstances.get(this.currentlyPlaying);n?.pauseVideo&&await n.pauseVideo()}r=!0,this.currentlyPlaying=e;try{e.setAttribute(this.PLAY_STATE_ATTR,this.PLAY_STATE_PLAYING),await i.setMuted(!1),await i.setVolume(1),await i.play()}catch(n){console.error("[InlineVimeoPlayer] Error playing on click:",n),r=!1,this.currentlyPlaying=null}}}),i.on("ended",()=>{r=!1,this.currentlyPlaying===e&&(this.currentlyPlaying=null),e.setAttribute(this.PLAY_STATE_ATTR,this.PLAY_STATE_NONE)}),window.IS_DEBUG_MODE&&console.debug("[InlineVimeoPlayer] Player initialized for",t)}catch(i){console.error("[InlineVimeoPlayer] Error initializing video:",i)}}destroy(){this.observer.disconnect(),this.videoInstances.forEach(e=>{try{e.destroy()}catch(t){console.error("[InlineVimeoPlayer] Error destroying player:",t)}}),this.videoInstances.clear()}};window.loadScript("https://player.vimeo.com/api/player.js",{name:"vimeo-sdk"});window.Webflow=window.Webflow||[];window.Webflow.push(()=>{!!window.Vimeo?.Player?new o:document.addEventListener("scriptLoaded:vimeo-sdk",()=>{new o},{once:!0})});})();
