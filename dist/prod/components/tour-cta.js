"use strict";(()=>{var p=class y{static instanceCount=0;constructor(){this.init()}init(){if(!window.matchMedia("(pointer: fine)").matches)return;document.querySelectorAll("svg[data-draw-svg]").forEach(n=>this.setupSVG(n))}setupSVG(t){let n=t.querySelector("[data-bg-rect]"),a=t.querySelector("[data-path]");if(!n||!a){console.error("Tour CTA: Missing required elements",{overlayRect:n,visiblePath:a,svg:t});return}let i=`draw-mask-${++y.instanceCount}`,r=this.ensureDefs(t),u=this.createMask(t,r,i),s=document.createElementNS("http://www.w3.org/2000/svg","path");s.setAttribute("fill","none"),s.setAttribute("stroke","black"),s.setAttribute("stroke-linecap","round"),s.setAttribute("stroke-linejoin","round"),s.setAttribute("stroke-width",a.getAttribute("stroke-width")||"24"),u.appendChild(s),n.setAttribute("mask",`url(#${i})`),a.setAttribute("stroke","none");let d=[],e=null,c=!1,h=!1,m=null,S=()=>{let o=d.filter(l=>l.length>0).map(l=>this.pointsToPathD(l)).join(" ");a.setAttribute("d",o),s.setAttribute("d",o)},E=o=>{e=[this.clientToSvgPoint(t,o.clientX,o.clientY)],d.push(e),c=!0,S()},A=()=>{if(h=!1,!c||!e||!m)return;let o=m,l=this.clientToSvgPoint(t,o.clientX,o.clientY),b=e[e.length-1],f=l.x-b.x,w=l.y-b.y,k=f*f+w*w,g=2;k<g*g||(e.push(l),S())},v=o=>{!c||!e||(m=o,h||(h=!0,requestAnimationFrame(A)))},P=()=>{c=!1,e=null};t.addEventListener("pointerenter",E),t.addEventListener("pointermove",v,{passive:!0}),t.addEventListener("pointerleave",P);let x=o=>{o.key==="Escape"&&(d.length=0,S())};t.addEventListener("keydown",x),t.setAttribute("tabindex",t.getAttribute("tabindex")??"0")}ensureDefs(t){let n=t.querySelector("defs");return n||(n=document.createElementNS("http://www.w3.org/2000/svg","defs"),t.insertBefore(n,t.firstChild)),n}createMask(t,n,a){let i=t.viewBox.baseVal,{x:r,y:u,width:s,height:d}=i&&i.width&&i.height?{x:i.x,y:i.y,width:i.width,height:i.height}:{x:0,y:0,width:t.clientWidth||1e3,height:t.clientHeight||1e3},e=document.createElementNS("http://www.w3.org/2000/svg","mask");e.setAttribute("id",a),e.setAttribute("maskUnits","userSpaceOnUse"),e.setAttribute("x",String(r)),e.setAttribute("y",String(u)),e.setAttribute("width",String(s)),e.setAttribute("height",String(d));let c=document.createElementNS("http://www.w3.org/2000/svg","rect");return c.setAttribute("x",String(r)),c.setAttribute("y",String(u)),c.setAttribute("width",String(s)),c.setAttribute("height",String(d)),c.setAttribute("fill","white"),e.appendChild(c),n.appendChild(e),e}clientToSvgPoint(t,n,a){let i=t.createSVGPoint();i.x=n,i.y=a;let r=t.getScreenCTM(),u=r?r.inverse():null;if(!u)return{x:0,y:0};let s=i.matrixTransform(u);return{x:s.x,y:s.y}}pointsToPathD(t){if(!t.length)return"";if(t.length===1){let r=t[0];return`M ${r.x} ${r.y} L ${r.x+.01} ${r.y+.01}`}let[n,...a]=t,i=a.map(r=>`L ${r.x} ${r.y}`).join(" ");return`M ${n.x} ${n.y} ${i}`}};new p;})();
