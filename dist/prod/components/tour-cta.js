"use strict";(()=>{var m=class y{static instanceCount=0;constructor(){this.init()}init(){document.querySelectorAll("svg[data-draw-svg]").forEach(n=>this.setupSVG(n))}setupSVG(t){let n=t.querySelector("[data-bg-rect]"),c=t.querySelector("[data-path]");if(!n||!c){console.error("Tour CTA: Missing required elements",{overlayRect:n,visiblePath:c,svg:t});return}t.style.touchAction="none";let r=`draw-mask-${++y.instanceCount}`,s=this.ensureDefs(t),l=this.createMask(t,s,r),o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("fill","none"),o.setAttribute("stroke","black"),o.setAttribute("stroke-linecap","round"),o.setAttribute("stroke-linejoin","round"),o.setAttribute("stroke-width",c.getAttribute("stroke-width")||"24"),l.appendChild(o),n.setAttribute("mask",`url(#${r})`);let d=[],i=null,a=!1,h=()=>{let e=d.filter(u=>u.length>0).map(u=>this.pointsToPathD(u)).join(" ");c.setAttribute("d",e),o.setAttribute("d",e)},g=e=>{e.pointerType==="touch"&&e.preventDefault(),t.setPointerCapture?.(e.pointerId),i=[this.clientToSvgPoint(t,e.clientX,e.clientY)],d.push(i),a=!0,h()},E=e=>{if(!a||!i)return;e.pointerType==="touch"&&e.preventDefault();let u=this.clientToSvgPoint(t,e.clientX,e.clientY),S=i[i.length-1],b=u.x-S.x,w=u.y-S.y,v=b*b+w*w,f=2;v<f*f||(i.push(u),h())},p=e=>{e&&e.pointerType==="touch"&&e.preventDefault(),a=!1,i=null};t.addEventListener("pointerdown",g),t.addEventListener("pointermove",E,{passive:!1}),t.addEventListener("pointerup",p),t.addEventListener("pointercancel",p),t.addEventListener("pointerleave",p);let A=e=>{e.key==="Escape"&&(d.length=0,h())};t.addEventListener("keydown",A),t.setAttribute("tabindex",t.getAttribute("tabindex")??"0")}ensureDefs(t){let n=t.querySelector("defs");return n||(n=document.createElementNS("http://www.w3.org/2000/svg","defs"),t.insertBefore(n,t.firstChild)),n}createMask(t,n,c){let r=t.viewBox.baseVal,{x:s,y:l,width:o,height:d}=r&&r.width&&r.height?{x:r.x,y:r.y,width:r.width,height:r.height}:{x:0,y:0,width:t.clientWidth||1e3,height:t.clientHeight||1e3},i=document.createElementNS("http://www.w3.org/2000/svg","mask");i.setAttribute("id",c),i.setAttribute("maskUnits","userSpaceOnUse"),i.setAttribute("x",String(s)),i.setAttribute("y",String(l)),i.setAttribute("width",String(o)),i.setAttribute("height",String(d));let a=document.createElementNS("http://www.w3.org/2000/svg","rect");return a.setAttribute("x",String(s)),a.setAttribute("y",String(l)),a.setAttribute("width",String(o)),a.setAttribute("height",String(d)),a.setAttribute("fill","white"),i.appendChild(a),n.appendChild(i),i}clientToSvgPoint(t,n,c){let r=t.createSVGPoint();r.x=n,r.y=c;let s=t.getScreenCTM(),l=s?s.inverse():null;if(!l)return{x:0,y:0};let o=r.matrixTransform(l);return{x:o.x,y:o.y}}pointsToPathD(t){if(!t.length)return"";if(t.length===1){let s=t[0];return`M ${s.x} ${s.y} L ${s.x+.01} ${s.y+.01}`}let[n,...c]=t,r=c.map(s=>`L ${s.x} ${s.y}`).join(" ");return`M ${n.x} ${n.y} ${r}`}};new m;})();
